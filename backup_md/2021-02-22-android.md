---
layout: post
date: 2021-02-23 00:00:10
title: "Android Exploit"
categories: CTF
tags: [Android]
author:
  - Jeongwon Jo

---
2020년 중반에 `인프런`이라는 플랫폼에서 강의를 보며 첫 안드로이드 해킹 공부를 시작 했었는데, 오랜만에 다시 안드로이드 공부를 하려고 합니다. 하지만 약 3개월 동안 하지 않아 frida 사용법이나 익스 코드 작성하는 방법을 조금 까먹어 `FridaLab`을 시작으로 여러 문제들을 다시 풀어 볼 계획입니다.

---
## <span style="color:#21C587"></span> FridaLab

> FridaLab 첫 번째 문제는 challenge_01 클래스의 chall01 이라는 변수의 값을 1로 수정해야 합니다.<br>

```java
package uk.rossmarks.fridalab;

public class challenge_01 {
    static int chall01;

    public static int getChall01Int() {
        return chall01;
    }
}
```
코드를 보면 `challenge_01` 클래스는 `uk.rossmarks.fridalab` 안에 있는 것을 볼 수 있고, `challenge_01` 클래스 내부에 `chall01` 변수가 있는 것을 볼 수 있습니다. 해당 값을 1로 바꿔주면 됩니다.

```javascript
setImmediate(function() {
	Java.perform(function() {
		const chall1 = Java.use("uk.rossmarks.fridalab.challenge_01");
		chall1.chall01.value = 1;
		console.log("Success");
	});
});
```
```
 py@py  ~/ApP/FridaLab  frida -U -l chall01.js uk.rossmarks.fridalab
     ____
    / _  |   Frida 12.11.7 - A world-class dynamic instrumentation toolkit
   | (_| |
    > _  |   Commands:
   /_/ |_|       help      -> Displays the help system
   . . . .       object?   -> Display information about 'object'
   . . . .       exit/quit -> Exit
   . . . .
   . . . .   More info at https://www.frida.re/docs/home/
Attaching...
Success
[SM-G965N::uk.rossmarks.fridalab]->
```
![](https://github.com/wjddnjs33/image/blob/main/FridaLab/%E1%84%89%E1%85%B3%E1%84%8F%E1%85%B3%E1%84%85%E1%85%B5%E1%86%AB%E1%84%89%E1%85%A3%E1%86%BA%202021-02-23%20%E1%84%8B%E1%85%A9%E1%84%8C%E1%85%A5%E1%86%AB%2012.04.52.png?raw=true)

자바스크립트를 이용해서 익스 코드를 위와 같이 작성해주었습니다. 모든 익스플로잇 코드는 `setImmediate` -> `Java.perform` 틀로 이루어져 있고, 상황에 맞게 `setTimeout` -> `setImmediate` -> `Java.perform` 틀로 사용할 수도 있습니다.<br>

> FridaLab 두 번째 문제는 Chall2() 메서드를 실행시키켜야 합니다.<br>

자고 일어나서 다시 런 할게요.

---
